<section class="dashboard-shell">
  <header class="topbar">
    <div class="brand">
      <span class="brand-mark">PF</span>
      <div>
        <p class="brand-name">PayFid</p>
        <p class="brand-tag">Transfer Command Center</p>
      </div>
    </div>
    <div class="account">
      <div>
        <p class="account-label">Account holder</p>
        <p class="account-name">{{ userName }}</p>
      </div>
      <button class="logout ghost" type="button" mat-stroked-button routerLink="/profile">View Profile</button>
    </div>
    <div class="topbar-actions">
      <button class="ghost" type="button" mat-stroked-button routerLink="/dashboard" routerLinkActive="active"
        [routerLinkActiveOptions]="routerLinkActiveOptions">Dashboard</button>
      <button class="ghost" type="button" mat-stroked-button routerLink="/history" routerLinkActive="active"
        [routerLinkActiveOptions]="routerLinkActiveOptions">History</button>
      <button class="ghost" type="button" mat-stroked-button routerLink="/transfer" routerLinkActive="active"
        [routerLinkActiveOptions]="routerLinkActiveOptions">New Transfer</button>
      <button class="ghost" type="button" mat-stroked-button routerLink="/analytics" routerLinkActive="active"
        [routerLinkActiveOptions]="routerLinkActiveOptions">Analytics</button>
      <button class="ghost" type="button" mat-stroked-button (click)="onLogout()">Log out</button>
    </div>
  </header>

  <main class="dashboard-grid">
    <mat-card class="card highlights">
      <h1>{{ isFirstLogin ? 'Welcome, ' : 'Welcome back, ' }}{{ userName }}</h1>
      <p>Live status of your payout corridors and risk posture.</p>
      <div class="balance">
        <p class="balance-label">Current balance</p>
        <p class="balance-value">{{ balance | currency:'INR':'symbol':'1.2-2' }}</p>
      </div>
      <div class="metrics">
        <div class="metric">
          <p class="metric-value">{{ processedToday | currency:'INR':'symbol':'1.0-0' }}</p>
          <p class="metric-label">Processed today</p>
        </div>
        <div class="metric">
          <p class="metric-value">{{ activeTransfers }}</p>
          <p class="metric-label">Active transfers</p>
        </div>
        <div class="metric">
          <p class="metric-value">1.8%</p>
          <p class="metric-label">At-risk volume</p>
        </div>
      </div>
    </mat-card>

    <mat-card class="card magic-card">
      <div class="card-glass">
        <div class="card-chip"></div>
        <div class="card-number">{{ cardDetails.number }}</div>
        <div class="card-info">
          <div>
            <p class="card-label">Card Holder</p>
            <p class="card-holder">{{ cardDetails.holder }}</p>
          </div>
          <div>
            <p class="card-label">Expires</p>
            <p class="card-expiry">{{ cardDetails.expiry }}</p>
          </div>
        </div>
        <div class="card-brand">{{ cardDetails.type }}</div>
      </div>
    </mat-card>

    <mat-card class="card activity">
      <div class="card-header">
        <h2>Recent Activity</h2>
        <button class="link" routerLink="/history">View all</button>
      </div>
      <div class="activity-list">
        @for (txn of recentTransactions; track txn.id) {
        <div class="activity-item">
          <div class="activity-icon" [ngClass]="getDisplayType(txn)">
            {{ getDisplayType(txn) === 'credit' ? '↓' : '↑' }}
          </div>
          <div class="activity-details">
            <p class="activity-title">{{ txn.description || 'Money Transfer' }}</p>
            <p class="activity-meta">{{ txn.date | date:'MMM d, h:mm a' }} • {{ txn.referenceId }}</p>
          </div>
          <div class="activity-amount" [ngClass]="getDisplayType(txn)">
            {{ getTransactionSign(txn) }}{{ txn.amount | currency:'INR':'symbol':'1.2-2' }}
          </div>
        </div>
        } @empty {
        <p class="no-activity">No recent transactions found.</p>
        }
      </div>
    </mat-card>

    <mat-card class="card activity compliance">
      <div class="card-header">
        <h2>Recent Payments</h2>
        <button class="link" routerLink="/history">View all</button>
      </div>
      <div class="activity-list small">
        @for (txn of recentTransactions; track txn.id) {
        <div class="activity-item">
          <div class="activity-details">
            <p class="activity-title">{{ (getDisplayType(txn) === 'credit' ? txn.fromAccountHolderName :
              txn.toAccountHolderName) || 'System' }}</p>
            <p class="activity-meta">{{ txn.amount | currency:'INR':'symbol':'1.2-2' }} • {{ txn.status | titlecase }}
            </p>
          </div>
          <div class="activity-amount" [ngClass]="getDisplayType(txn)">
            {{ getTransactionSign(txn) }}{{ txn.amount | currency:'INR':'symbol':'1.2-2' }}
          </div>
        </div>
        } @empty {
        <p class="no-activity">No recent payments found.</p>
        }
      </div>
    </mat-card>
  </main>

  <nav class="bottom-nav">
    <button type="button" class="nav-item" mat-button routerLink="/dashboard" routerLinkActive="active"
      [routerLinkActiveOptions]="routerLinkActiveOptions">Dashboard</button>
    <button type="button" class="nav-item" mat-button routerLink="/history" routerLinkActive="active"
      [routerLinkActiveOptions]="routerLinkActiveOptions">History</button>
    <button type="button" class="nav-item" mat-button routerLink="/transfer" routerLinkActive="active"
      [routerLinkActiveOptions]="routerLinkActiveOptions">New Transfer</button>
    <button type="button" class="nav-item" mat-button routerLink="/analytics" routerLinkActive="active"
      [routerLinkActiveOptions]="routerLinkActiveOptions">Analytics</button>
    <button type="button" class="nav-item logout" mat-button (click)="onLogout()">Log out</button>
  </nav>
</section>

<footer class="app-footer">
  <div class="footer-content">
    <div class="footer-section">
      <h4 class="footer-heading">Support</h4>
      <button type="button" class="footer-link">Security</button>
      <button type="button" class="footer-link">Preferences</button>
      <button type="button" class="footer-link">Help & Support</button>
    </div>
    <div class="footer-section">
      <h4 class="footer-heading">Legal</h4>
      <button type="button" class="footer-link">Privacy Policy</button>
      <button type="button" class="footer-link">Terms & Conditions</button>
      <button type="button" class="footer-link">Cookie Policy</button>
    </div>
    <div class="footer-section">
      <h4 class="footer-heading">Contact</h4>
      <p class="footer-text">Email: support@payfid.com</p>
      <p class="footer-text">Phone: +91 1800 123 4567</p>
    </div>
  </div>
  <div class="footer-bottom">
    <p class="footer-copyright">&copy; 2026 PayFid. All rights reserved.</p>
  </div>
</footer>